{
  "title": "Find Product Recommendation Pairs",
  "problem_id": "3865",
  "frontend_id": "3521",
  "difficulty": "Medium",
  "problem_slug": "find-product-recommendation-pairs",
  "topics": [
    "Database"
  ],
  "description": "Table: ProductPurchases\nTable: ProductInfo\nAmazon wants to implement the Customers who bought this also bought... feature based on co-purchase patterns. Write a solution to :\nA product pair is considered for recommendation if at least 3 different customers have purchased both products.\nReturn the result table ordered by customer_count in descending order, and in case of a tie, by product1_id in ascending order, and then by product2_id in ascending order.\nThe result format is in the following example.\nExample:",
  "examples": [
    {
      "example_num": 1,
      "example_text": "+-------------+------+\n| Column Name | Type | \n+-------------+------+\n| user_id     | int  |\n| product_id  | int  |\n| quantity    | int  |\n+-------------+------+\n(user_id, product_id) is the unique key for this table.\nEach row represents a purchase of a product by a user in a specific quantity.",
      "images": []
    },
    {
      "example_num": 2,
      "example_text": "+-------------+---------+\n| Column Name | Type    | \n+-------------+---------+\n| product_id  | int     |\n| category    | varchar |\n| price       | decimal |\n+-------------+---------+\nproduct_id is the primary key for this table.\nEach row assigns a category and price to a product.",
      "images": []
    },
    {
      "example_num": 3,
      "example_text": "+---------+------------+----------+\n| user_id | product_id | quantity |\n+---------+------------+----------+\n| 1       | 101        | 2        |\n| 1       | 102        | 1        |\n| 1       | 103        | 3        |\n| 2       | 101        | 1        |\n| 2       | 102        | 5        |\n| 2       | 104        | 1        |\n| 3       | 101        | 2        |\n| 3       | 103        | 1        |\n| 3       | 105        | 4        |\n| 4       | 101        | 1        |\n| 4       | 102        | 1        |\n| 4       | 103        | 2        |\n| 4       | 104        | 3        |\n| 5       | 102        | 2        |\n| 5       | 104        | 1        |\n+---------+------------+----------+",
      "images": []
    },
    {
      "example_num": 4,
      "example_text": "+------------+-------------+-------+\n| product_id | category    | price |\n+------------+-------------+-------+\n| 101        | Electronics | 100   |\n| 102        | Books       | 20    |\n| 103        | Clothing    | 35    |\n| 104        | Kitchen     | 50    |\n| 105        | Sports      | 75    |\n+------------+-------------+-------+",
      "images": []
    },
    {
      "example_num": 5,
      "example_text": "+-------------+-------------+-------------------+-------------------+----------------+\n| product1_id | product2_id | product1_category | product2_category | customer_count |\n+-------------+-------------+-------------------+-------------------+----------------+\n| 101         | 102         | Electronics       | Books             | 3              |\n| 101         | 103         | Electronics       | Clothing          | 3              |\n| 102         | 104         | Books             | Kitchen           | 3              |\n+-------------+-------------+-------------------+-------------------+----------------+",
      "images": []
    }
  ],
  "constraints": [],
  "follow_ups": [],
  "hints": [],
  "code_snippets": {
    "mysql": "# Write your MySQL query statement below\n",
    "mssql": "/* Write your T-SQL query statement below */\n",
    "oraclesql": "/* Write your PL/SQL query statement below */\n",
    "pythondata": "import pandas as pd\n\ndef find_product_recommendation_pairs(product_purchases: pd.DataFrame, product_info: pd.DataFrame) -> pd.DataFrame:\n    ",
    "postgresql": "-- Write your PostgreSQL query statement below\n"
  }
}