{
  "title": "Find Drivers with Improved Fuel Efficiency",
  "problem_id": "3942",
  "frontend_id": "3601",
  "difficulty": "Medium",
  "problem_slug": "find-drivers-with-improved-fuel-efficiency",
  "topics": [
    "Database"
  ],
  "description": "Table: drivers\nTable: trips\nWrite a solution to find drivers whose fuel efficiency has improved by comparing their average fuel efficiency in the first half of the year with the second half of the year.\nReturn the result table ordered by efficiency improvement in descending order, then by driver name in ascending order.\nThe result format is in the following example.\nExample:",
  "examples": [
    {
      "example_num": 1,
      "example_text": "+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| driver_id   | int     |\n| driver_name | varchar |\n+-------------+---------+\ndriver_id is the unique identifier for this table.\nEach row contains information about a driver.",
      "images": []
    },
    {
      "example_num": 2,
      "example_text": "+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| trip_id       | int     |\n| driver_id     | int     |\n| trip_date     | date    |\n| distance_km   | decimal |\n| fuel_consumed | decimal |\n+---------------+---------+\ntrip_id is the unique identifier for this table.\nEach row represents a trip made by a driver, including the distance traveled and fuel consumed for that trip.",
      "images": []
    },
    {
      "example_num": 3,
      "example_text": "+-----------+---------------+\n| driver_id | driver_name   |\n+-----------+---------------+\n| 1         | Alice Johnson |\n| 2         | Bob Smith     |\n| 3         | Carol Davis   |\n| 4         | David Wilson  |\n| 5         | Emma Brown    |\n+-----------+---------------+",
      "images": []
    },
    {
      "example_num": 4,
      "example_text": "+---------+-----------+------------+-------------+---------------+\n| trip_id | driver_id | trip_date  | distance_km | fuel_consumed |\n+---------+-----------+------------+-------------+---------------+\n| 1       | 1         | 2023-02-15 | 120.5       | 10.2          |\n| 2       | 1         | 2023-03-20 | 200.0       | 16.5          |\n| 3       | 1         | 2023-08-10 | 150.0       | 11.0          |\n| 4       | 1         | 2023-09-25 | 180.0       | 12.5          |\n| 5       | 2         | 2023-01-10 | 100.0       | 9.0           |\n| 6       | 2         | 2023-04-15 | 250.0       | 22.0          |\n| 7       | 2         | 2023-10-05 | 200.0       | 15.0          |\n| 8       | 3         | 2023-03-12 | 80.0        | 8.5           |\n| 9       | 3         | 2023-05-18 | 90.0        | 9.2           |\n| 10      | 4         | 2023-07-22 | 160.0       | 12.8          |\n| 11      | 4         | 2023-11-30 | 140.0       | 11.0          |\n| 12      | 5         | 2023-02-28 | 110.0       | 11.5          |\n+---------+-----------+------------+-------------+---------------+",
      "images": []
    },
    {
      "example_num": 5,
      "example_text": "+-----------+---------------+------------------+-------------------+------------------------+\n| driver_id | driver_name   | first_half_avg   | second_half_avg   | efficiency_improvement |\n+-----------+---------------+------------------+-------------------+------------------------+\n| 2         | Bob Smith     | 11.24            | 13.33             | 2.10                   |\n| 1         | Alice Johnson | 11.97            | 14.02             | 2.05                   |\n+-----------+---------------+------------------+-------------------+------------------------+",
      "images": []
    }
  ],
  "constraints": [],
  "follow_ups": [],
  "hints": [],
  "code_snippets": {
    "mysql": "# Write your MySQL query statement below\n",
    "mssql": "/* Write your T-SQL query statement below */\n",
    "oraclesql": "/* Write your PL/SQL query statement below */\n",
    "pythondata": "import pandas as pd\n\ndef find_improved_efficiency_drivers(drivers: pd.DataFrame, trips: pd.DataFrame) -> pd.DataFrame:\n    ",
    "postgresql": "-- Write your PostgreSQL query statement below\n"
  }
}